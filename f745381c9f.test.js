// Test generated by RoostGPT for testing ExpressJs using AI Type Open AI and AI Model gpt-4

import express from "express";
import request from "supertest";
import app from "./index.js";
import jwt from "jsonwebtoken";

describe("GET / - homepage", () => {
  let server;

  beforeAll(async () => {
    server = express();
    server.use('/', app);
  });

  test("should return user name when authenticated", async () => {
    const token = jwt.sign({ name: "testUser" }, "secretKey");
    const response = await request(server)
      .get("/")
      .set("Cookie", `token=${token}`);

    expect(response.status).toBe(200);
    expect(response.body.name).toBe("testUser");
  });

  test("should return error when not authenticated", async () => {
    const response = await request(server)
      .get("/")
      .set("Cookie", "");

    expect(response.status).toBe(401);
    expect(response.body.error).toBe("User is not authenticated");
  });
});
